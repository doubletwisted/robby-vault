<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Robby Vault — Showcase</title>
  <style>
    :root{--bg:#05060a;--ink:#f3f3f3;--muted:#9aa0b2;--hair:rgba(255,255,255,.14);--acid:#b6ff4a}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:13px/1.35 ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:hidden}
    iframe{position:fixed;inset:0;width:100%;height:100%;border:0;background:#000}
    .hud{position:fixed;left:14px;top:14px;z-index:10;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .pill{border:1px solid var(--hair);background:rgba(0,0,0,.35);backdrop-filter: blur(10px);padding:9px 10px;border-radius:12px;color:var(--muted)}
    a{color:var(--ink);text-decoration:none}
    .name{color:var(--ink);letter-spacing:.2em;text-transform:uppercase}
    .score{color:var(--acid)}
  </style>
</head>
<body>
  <div class="hud">
    <div class="pill"><span class="name" id="name">SHOWCASE</span> · <span class="score" id="score">—</span></div>
    <div class="pill"><a href="vault">← vault</a></div>
  </div>
  <iframe id="frame" src="about:blank" allow="fullscreen"></iframe>

  <script>
    const items = [
      'robby_bitfield.html','robby_core.html','robby_core_v2.html','robby_engine.html','robby_fabric.html','robby_feedback.html','robby_flux.html','robby_freestyle.html','robby_ghost.html','robby_grid.html','robby_horizon.html','robby_horizon_v2.html','robby_lattice.html','robby_liquid.html','robby_loom.html','robby_mesh.html','robby_monolith.html','robby_nebula.html','robby_pulse.html','robby_relic.html','robby_remnant.html','robby_sigil.html','robby_terminal.html','robby_weaver.html','robby_xor.html',
      'robby_ca_life.html','robby_ca_cyclic.html','robby_ca_rule110.html','robby_ca_langton.html','robby_ca_brians_brain.html','robby_ca_wireworld.html'
    ];

    function niceName(file){
      return file.replace(/^robby_/,'').replace(/\.html$/,'').replaceAll('_',' ').replaceAll('ca ','ca: ').toUpperCase();
    }

    async function main(){
      let likes = {};
      try{
        const r = await fetch('/api/likes', { cache: 'no-store' });
        if(r.ok) likes = await r.json();
      }catch{}

      const ranked = items
        .map(f=>({f, c:Number(likes[f]||0)}))
        .sort((a,b)=>(b.c-a.c) || a.f.localeCompare(b.f));

      const pick = ranked[0]?.f || items[0];
      const score = ranked[0]?.c || 0;

      document.getElementById('name').textContent = niceName(pick);
      document.getElementById('score').textContent = `${score} likes`;
      document.getElementById('frame').src = pick;
    }

    main();
  </script>
</body>
</html>
